@using INVUIs.Products.ProductsModel

@rendermode InteractiveServer

<RadzenDataGrid @ref="grid" TItem="ProductModel" Data="@products" AllowVirtualization="true" Style="height:400px"
                GridLines="DataGridGridLines.Horizontal">
    <HeaderTemplate>
        <RadzenButton ButtonStyle="ButtonStyle.Success" Icon="add_circle" Text="Add New Order" Click="() => productSelector.ShowModal()"/>
        <RadzenButton ButtonStyle="ButtonStyle.Base" Icon="note_add" Text="Create New Product" Click="() => productForm.ShowModal()"/>

    </HeaderTemplate>
    <Columns>
        <RadzenDataGridColumn Property="Number" Title="N°" Width="7%"/>
        <RadzenDataGridColumn Property="Designation" Title="Data" Width="34%"/>
        <RadzenDataGridColumn Property="UnitMeasure" Title="Unit" Width="10%"/>
        <RadzenDataGridColumn Property="Quantity" Title="Quantity" Width="10%"/>
        <RadzenDataGridColumn Property="UnitPrice" Title="Unit Price" Width="10%"/>
        <RadzenDataGridColumn Property="TVA" Title="TVA" Width="9%">
            <Template Context="product">
                @product.TVA %
            </Template>
        </RadzenDataGridColumn>
        <RadzenDataGridColumn Property="TotalPrice" Title="Total" Width="18%">
            <Template Context="product">
                @((product.UnitPrice * product.Quantity).ToString("N"))
            </Template>
            <FooterTemplate>
                <strong>Total: @getTotalPrice().ToString("N")</strong>
            </FooterTemplate>
        </RadzenDataGridColumn>
        <RadzenDataGridColumn Title="" Width="15%">
            <Template Context="product">
                <RadzenButton ButtonStyle="ButtonStyle.Success" Click="() => EditProduct(product)" Icon="offline_pin"></RadzenButton>
                <RadzenButton ButtonStyle="ButtonStyle.Danger" Click="() => DeleteProduct(product)" Icon="highlight_off"></RadzenButton>
            </Template>
        </RadzenDataGridColumn>
    </Columns>
</RadzenDataGrid>

<ProductForm @ref="productForm"/>
<ProductSelector @ref="productSelector" OnProductSelectedEvent="AddProductToGrid" OnCreateNewProduct="ShowProductForm"/>


@code {

    private void ShowProductForm()
    {
        productForm.ShowModal();
    }

}

@*<RadzenTemplateForm>
    <RadzenLabel Text="Delivery time :"/>
    <RadzenNumeric id="delivery_time" @bind-Value="newProduct.DateDilevry"/> days
    <RadzenRequiredValidator Component="UnitMeasure" Text="Unit of Measure is required"/>
    
</RadzenTemplateForm>*@